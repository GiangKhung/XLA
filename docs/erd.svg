<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="900" viewBox="0 0 1200 900">
  <defs>
    <pattern id="checker" width="40" height="40" patternUnits="userSpaceOnUse">
      <rect width="40" height="40" fill="#1f1f1f" />
      <rect width="20" height="20" fill="#262626" />
      <rect x="20" y="20" width="20" height="20" fill="#262626" />
    </pattern>

    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="4" stdDeviation="6" flood-color="#000" flood-opacity="0.45" />
    </filter>

    <marker id="arrow" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#98a8b9" />
    </marker>
  </defs>

  <style>
    .bg { fill: url(#checker); }
    .card { fill: #ffffff; stroke: #2b3a42; stroke-width:2px; rx:8px; ry:8px; }
    .title { font: 700 14px 'Helvetica Neue', Arial, sans-serif; fill:#0f1720; }
    .attrs { font: 12px 'Courier New', monospace; fill:#243840; }
    .pk { font-weight:700; }
    .fk { font-style:italic; fill:#4b6874; }
    .rel { stroke:#3f5360; stroke-width:1.8px; fill:none; marker-end:url(#arrow); }
    .note { font: 12px sans-serif; fill:#e6eef4; }
    .legend-box { fill:#0f1720; fill-opacity:0.75; stroke:#21303a; }
  </style>

  <!-- Background -->
  <rect width="1200" height="900" class="bg" />

  <!-- Entities arranged like sample image -->
  <!-- User (top-left) -->
  <g transform="translate(60,60)" filter="url(#shadow)">
    <rect class="card" width="240" height="120" rx="8"/>
    <text x="120" y="26" text-anchor="middle" class="title">User</text>
    <text x="18" y="52" class="attrs pk">id (PK)</text>
    <text x="18" y="72" class="attrs">name</text>
    <text x="18" y="92" class="attrs">email</text>
    <text x="18" y="112" class="attrs">created_at</text>
  </g>

  <!-- Image (top-center) -->
  <g transform="translate(360,40)" filter="url(#shadow)">
    <rect class="card" width="260" height="150" rx="8"/>
    <text x="130" y="26" text-anchor="middle" class="title">Image</text>
    <text x="16" y="60" class="attrs pk">id (PK)</text>
    <text x="16" y="82" class="attrs">filename</text>
    <text x="16" y="102" class="attrs">filepath</text>
    <text x="16" y="122" class="attrs">size_bytes</text>
    <text x="16" y="142" class="attrs fk">user_id (FK → User.id)</text>
  </g>

  <!-- CompressionResult (top-right) -->
  <g transform="translate(760,50)" filter="url(#shadow)">
    <rect class="card" width="320" height="190" rx="8"/>
    <text x="160" y="26" text-anchor="middle" class="title">CompressionResult</text>
    <text x="18" y="62" class="attrs pk">id (PK)</text>
    <text x="18" y="84" class="attrs fk">image_id (FK → Image.id)</text>
    <text x="18" y="104" class="attrs fk">algorithm_id (FK → Algorithm.id)</text>
    <text x="18" y="124" class="attrs">file_path</text>
    <text x="18" y="144" class="attrs">file_size</text>
    <text x="18" y="164" class="attrs">psnr / ssim / time</text>
  </g>

  <!-- Algorithm (center) -->
  <g transform="translate(420,230)" filter="url(#shadow)">
    <rect class="card" width="240" height="120" rx="8"/>
    <text x="120" y="26" text-anchor="middle" class="title">Algorithm</text>
    <text x="16" y="56" class="attrs pk">id (PK)</text>
    <text x="16" y="76" class="attrs">name</text>
    <text x="16" y="96" class="attrs">type</text>
  </g>

  <!-- Comparison (bottom-left) -->
  <g transform="translate(60,360)" filter="url(#shadow)">
    <rect class="card" width="260" height="120" rx="8"/>
    <text x="130" y="26" text-anchor="middle" class="title">Comparison</text>
    <text x="16" y="56" class="attrs pk">id (PK)</text>
    <text x="16" y="76" class="attrs fk">image_id (FK → Image.id)</text>
    <text x="16" y="96" class="attrs">created_at</text>
  </g>

  <!-- ComparisonAlgorithm (bottom-center) -->
  <g transform="translate(360,380)" filter="url(#shadow)">
    <rect class="card" width="260" height="110" rx="8"/>
    <text x="130" y="22" text-anchor="middle" class="title">ComparisonAlgorithm</text>
    <text x="16" y="52" class="attrs fk">comparison_id (FK → Comparison.id)</text>
    <text x="16" y="72" class="attrs fk">algorithm_id (FK → Algorithm.id)</text>
    <text x="16" y="92" class="attrs">metric_summary</text>
  </g>

  <!-- Recommendation (bottom-right) -->
  <g transform="translate(760,360)" filter="url(#shadow)">
    <rect class="card" width="320" height="120" rx="8"/>
    <text x="160" y="26" text-anchor="middle" class="title">Recommendation</text>
    <text x="18" y="56" class="attrs pk">id (PK)</text>
    <text x="18" y="76" class="attrs fk">image_id (FK → Image.id)</text>
    <text x="18" y="96" class="attrs fk">algorithm_id (FK → Algorithm.id)</text>
    <text x="18" y="116" class="attrs">reason / score</text>
  </g>

  <!-- Relationships (arrows) -->
  <!-- User -> Image -->
  <path d="M300 120 L360 120" class="rel" />
  <text x="310" y="108" class="note">1</text>
  <text x="340" y="108" class="note">*</text>

  <!-- Image -> CompressionResult -->
  <path d="M620 120 L760 120" class="rel" />
  <text x="660" y="108" class="note">1</text>
  <text x="730" y="108" class="note">*</text>

  <!-- Algorithm -> CompressionResult -->
  <path d="M480 290 L760 180" class="rel" />
  <text x="520" y="250" class="note">1</text>
  <text x="650" y="190" class="note">*</text>

  <!-- Image -> Comparison -->
  <path d="M420 140 L200 360" class="rel" />
  <text x="300" y="240" class="note">1</text>
  <text x="240" y="340" class="note">*</text>

  <!-- Comparison <-> Algorithm via ComparisonAlgorithm -->
  <path d="M420 320 L420 380" class="rel" />
  <path d="M520 420 L420 420" class="rel" />
  <text x="430" y="350" class="note">* - *</text>

  <!-- Image -> Recommendation -->
  <path d="M620 140 L760 360" class="rel" />
  <text x="680" y="240" class="note">1</text>
  <text x="740" y="320" class="note">*</text>

  <!-- Legend box (bottom) -->
  <g transform="translate(40,520)">
    <rect class="legend-box" width="1080" height="260" rx="6"/>
    <text x="20" y="30" class="note" style="font-weight:700;">ERD Legend / Notes</text>
    <text x="20" y="58" class="note">- PK: Primary Key, FK: Foreign Key</text>
    <text x="20" y="80" class="note">- `Image` stores uploaded originals; `CompressionResult` stores each compressed file and metrics (psnr, ssim, time)</text>
    <text x="20" y="102" class="note">- `Algorithm` catalogs compression methods (JPEG, PNG, WebP...)</text>
    <text x="20" y="124" class="note">- `Comparison` groups a comparison run for an image; `ComparisonAlgorithm` links algorithms used in that comparison</text>
    <text x="20" y="146" class="note">- `Recommendation` stores suggested best algorithm(s) per image and a reason/score</text>
  </g>

</svg>
